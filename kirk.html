<canvas id="content" width="800" height="600"></canvas>

<script>
  function $(a){return document.getElementById(a);}
  let canvas = $('content');
  let ctx = canvas.getContext('2d');
  let sprites = {
    "kirk":{src:"./kirk.jpeg",ready:false},
    "netanyahu":{src:"./netanyahoo.jpg",ready:false}
  };
  Object.keys(sprites).forEach(spriteName => {
    let sprite = sprites[spriteName];
    sprite.img = new Image();
    sprite.img.src = sprite.src;
    sprite.img.onload = () => {
      sprite.ready = true;
    }
  });

  function colliding(div1, div2) {
  const rect1 = div1;
  const rect2 = div2;

  // Check for horizontal overlap
  const horizontalOverlap = rect1.x < rect2.x + rect2.width && rect1.x + rect1.width > rect2.x;

  // Check for vertical overlap
  const verticalOverlap = rect1.y < rect2.y + rect2.height && rect1.y + rect1.height > rect2.y;

  // Collision occurs if there is both horizontal and vertical overlap
  return horizontalOverlap && verticalOverlap;
}

  
  function drawSprite(sprite,x,y,w,h){
    if(sprite.ready){
      ctx.drawImage(sprite.img,x,y,w,h);
    }
  }
  let keys = {w:false,a:false,s:false,d:false," ":false};
  let groundHeight = 500;
  let player = {x:0,y:groundHeight,xVelocity:0,maxSpeed:2,accel:5,canJump:true}
  //xVelocity+=player.accel/100;

  document.onkeydown = (e) => {if(Object.keys(keys).includes(e.key.toLowerCase()))keys[e.key.toLowerCase()]=true;}
  document.onkeyup = (e) => {if(Object.keys(keys).includes(e.key.toLowerCase()))keys[e.key.toLowerCase()]=false;}
  let netanyahoos = [];
  function netanyahoo(){
    let thisNetanyahoo = {x:Math.floor(Math.random()*canvas.width),y:0,speed:Math.floor(Math.random()*2)+1};
    netanyahoos.push(thisNetanyahoo);
  }
  function worldLoop(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    if(keys.a && player.xVelocity > (0-player.maxSpeed))player.xVelocity-=player.accel/100;
    if(keys.d && player.xVelocity < player.maxSpeed)player.xVelocity+=player.accel/100;
    if(!keys.d && !keys.a){
      if(player.xVelocity < 0)player.xVelocity+=player.accel/100;
      if(player.xVelocity > 0)player.xVelocity-=player.accel/100;
    }
    let c = Math.random();
    if(c > 0.98)netanyahoo();
    netanyahoos.forEach((netanyahooer,idx) => {
      netanyahooer.y+=netanyahooer.speed;
      drawSprite(sprites["netanyahu"],netanyahooer.x,netanyahooer.y,80,160);
      if(netanyahooer.y > groundHeight)netanyahoos.splice(idx,1);
      if(colliding({x:player.x,y:player.y,width:100,height:100},{x:netanyahooer.x,y:netanyahooer.y,width:100,height:200}) ){
        document.body.innerHTML = "<h1>GAME OVER</h1> <hr>refresh page to start over"
      }
    });
    
    player.x+=player.xVelocity;
    drawSprite(sprites["kirk"],player.x,player.y,60,60);
    setTimeout(worldLoop,10);
  }
  worldLoop();
</script>
